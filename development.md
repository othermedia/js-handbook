---
layout:   article
title:    Developing new libraries
previous: libraries
next:     deployment
---


Our toolchain
-------------

Much of our JavaScript development toolchain consists of utilities written in
Ruby. To get them up and running on your system you'll need Ruby 1.8.6 or
higher and Rubygems, the Ruby package manager. Once those are installed, you
just need to run the following command to install the relevant dependencies:

    sudo gem install jake helium

All of our internal libraries, including JS.Class and Ojay, are kept under
version control with [Git][git]. You will need a recent version of Git
installed on your computer in order to develop new libraries and modify
existing ones. It's very likely available through your operating system's
package manager (e.g. `aptitude` on Ubuntu), but installing it from source is
a relatively painless procedure.

There are many introductory Git tutorials available on the web. The Git
repository hosting site, [GitHub][github], list several on
[their help site][ghhelp]. If you need commit access to any of our GitHub
repositories, just ask. Please note, however, that Git is a _distributed_
version control system: you can get a full copy of the entire repository and
commit changes locally, without needing to have commit rights to the version
on GitHub.


[git]:    http://git-scm.com/
[github]: http://github.com/
[ghhelp]: http://help.github.com/
[ghtom]:  http://github.com/othermedia


Build tools
-----------

[Jake][jake] is a command line tool for building JavaScript packages from
source code. Using YAML config files, you can specify any number of build files
to be generated by concatenating and minifying groups of source files. All of
our JavaScript libraries, if they exist outside a particular client project,
have a Jake config file, `jake.yml`.

These config files also specify the JavaScript objects that the library
provides, and which other objects they rely on. For example, the [Panel][panel]
library provides three objects--`panel`, `Panel` and `PanelOverlay`--and
depends on four: `JS.Class`, `Ojay`, `Ojay.HTML` and `Ojay.ContentOverlay`.

This dependency data is used by our other JavaScript deployment tool,
[Helium][helium].


[jake]:   http://github.com/jcoglan/jake
[helium]: http://github.com/othermedia/helium
[panel]:  http://github.com/othermedia/panel


Extractions
-----------

JavaScript libraries tend to begin their lives in client projects. After all,
we don't write these things for no reason: they're created to address specific
needs. However, as soon as something begins to be used for more than one
project, it needs to be extracted into a separate library.


Writing the library
-------------------

The first step in writing a new library is to generate a stub project with the
Helium command line tool. Just run the `he create` command:

    he create my-library

Obviously `my-library` should be the name of the library you're writing.

* Generating a stub project with `he create`
* Moving your existing code into the stub project
* Making the code more general
* Writing test cases


Dependency management
---------------------

* JS.Packages
* Writing manifests
* Custom loaders
